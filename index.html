<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
	<title>Node</title>
	
	<link rel="stylesheet" href="jquery.treeview.css" />
	<link rel="stylesheet" href="screen.css" />
	
	<script src="jquery.js" type="text/javascript"></script>
	<script src="jquery.cookie.js" type="text/javascript"></script>
	<script src="jquery.treeview.js" type="text/javascript"></script>
	<script src="jquery.treeview.async.js" type="text/javascript"></script>
	
	<script type="text/javascript">
	$(document).ready(function(){
		$.ajaxSetup({
		  cache: false
		});
		$("#black").treeview({
			url: "/tree",
			unique: true
		})
	});
	
	function evalStr(str) {
		$.getJSON("/eval?eval="+encodeURIComponent(str),
		function(data){
			if (data.error !== true) {
				$("#console").prepend('<pre class="command">'+data.str+'</pre><pre class="result">'+data.result+'</pre>');
			} else {
				$("#console").prepend('<pre class="command">'+data.str+'</pre><pre class="result">Error - '+data.result.message+'</pre>');
			}
        });
	}
	
	function refresh() {
		$("#black").remove();
		$("#bottom").append('<ul id="black"></ul>');
		$("#black").treeview({
			url: "/tree",
			unique: true
		});
	}
	</script>
	
<style type="text/css">
		#top, #bottom {
			height: 50%;
			width: 100%;
		}
		#left, #right {
			width: 50%;
			height: 100%;
			float: left;
		}
		#console {
			
			overflow: auto;
			height: 100%;
		}
		#bottom {
			overflow: auto;
		}
		#black {
			padding: 10px;
			overflow: hidden;
		}
		#input {
			height: 100%;
			width: 100%;
		}
		.result {
			font-weight: bold;
			border-bottom: 1px dashed grey;
		}
		
		pre {
			font-family: sans-serif;
			overflow: auto;
			width: 100%;
			max-height: 200px;
		}
		
		body {
			overflow: hidden;
		}
	</style>
	
	</head>
	<body>
		<div id="top">
			<div id="left">
					<div id="console">
					
					</div>
			</div>
			<div id="right">
					<textarea id="input"></textarea>
					<a href="#" onclick="evalStr($('#input').val()); return false;">Execute</a> - <a href="#" onclick="refresh(); return false;">Refresh tree</a>
			</div>
		</div>
		<div id="bottom">
			<ul id="black">
			</ul>
		</div>
	</body>
</html>